--Lachlan Moore, 30030228
-- CPSC 449, Fall 2019
-- Exercise 2


--1. twoTautology and twoEquiv



--2. Shows Fermat's conjecture is false by finding a number for which it is not true
badFermat :: Integer
badFermat = bfHelper 1
   where
      ex n = 2^(2^n) + 1
      bfHelper n
         | isPrime (ex n) = bfHelper (n+1)
         | otherwise = n


isPrime :: Integer -> Bool
isPrime n = case (filter (\x -> (n `mod` x) == 0) [2..(n-1)]) of
            [] -> True
            (a:as) -> False

cartProd :: [a] -> [b] -> [(a,b)]
cartProd xs ys = [(x,y) | x <- xs, y <- ys]

allTwoBools :: [(Bool, Bool)]
allTwoBools = cartProd [True, False] [True, False]

--3. collatz and  collatzIndex
data SF a = SS a |  FF
     deriving (Eq,Show)

collatz :: Int -> Int
collatz n
   | even (n) = (n `div` 2)
   | otherwise = (3 * n) + 1

collatzIndex :: Int -> SF [Int]
collatzIndex n
   | n < 1 = FF
   | n == 1 = SS [n]
   | otherwise = SS (chelper(n))

chelper :: Int -> [Int]
chelper n
   | n == 1 = [1]
   | otherwise = n:chelper (collatz n)

--4. Bisection method to find roots to continuous functions
bisection :: (Double -> Double) -> (Double, Double) -> Maybe Double
bisection = undefined

--5. Quick, Bubble and Merge sort in haskell

--Quick sort
qsort :: (a -> a -> Bool) -> [a] -> [a]
qsort f [] = []
qsort f (x:xs) = smaller ++ [x] ++ larger
   where
      smaller = qsort f [a | a <- xs, f a x]
      larger = qsort f [a | a <- xs, f x a]

--Bubble sort
bsort :: (a -> a -> Bool) -> [a] -> [a]
bsort f xs
   | isSorted f (xs) == True = xs
   | otherwise = bsort f (bubble f xs)
      
bubble :: (a -> a -> Bool) -> [a] -> [a]
bubble f [] = []
bubble f (x:[]) = x:[]
bubble f (x:(y:ys))
   | f x y = x:(bubble f (y:ys)) 
   | otherwise = y:(bubble f (x:ys))
      
isSorted :: (a -> a -> Bool) -> [a] -> Bool
isSorted f [] = True
isSorted f [x] = True
isSorted f (x:(y:ys)) 
   | f x y = isSorted f (y:ys) 
   | otherwise = False

-- Merge Sort
msort :: (a -> a -> Bool) -> [a] -> [a]
msort f []  = []
msort f [x] = [x]
msort f xs  = merge f firstHalfSorted secondHalfSorted
     where firstHalfSorted  = msort f . fst $ halves
           secondHalfSorted = msort f . snd $ halves
           halves           = splitAt halfPoint xs
           halfPoint        = length xs `div` 2
   
merge :: (a -> a -> Bool) -> [a] -> [a] -> [a]
merge f [] ys = ys
merge f xs [] = xs
merge f (x:xs) (y:ys) 
   | f x y     = x : merge f xs (y:ys)
   | otherwise = y : merge f (x:xs) ys

--6. Matrix functions
type Matrix a = [[a]]
type DoubleMatrix = Matrix Double

transpose :: Matrix a -> (Maybe (Matrix a))
transpose ([]:_) = Nothing
transpose x = Just (thelp(x))

thelp :: Matrix a -> Matrix a
thelp ([]:_) = []
thelp x = (map head x) : thelp (map tail x)

addMat :: DoubleMatrix -> DoubleMatrix -> (Maybe DoubleMatrix)
addMat [] [] = Nothing
addMat x y = Just (ahelp x y)

ahelp :: DoubleMatrix -> DoubleMatrix -> DoubleMatrix
ahelp [] [] = []
ahelp (x:xs) (y:ys) = zipWith (+) x y : ahelp xs ys

multMat :: DoubleMatrix -> DoubleMatrix -> (Maybe DoubleMatrix)
multMat [] [] = Nothing
multMat a b = Just (mhelp a b)

mhelp :: DoubleMatrix -> DoubleMatrix -> DoubleMatrix
mhelp [] [] = []
mhelp a b = [ [sum $ zipWith (*) ar bc | bc <- (thelp b) ] | ar <- a]

--7. naive reverse, fast reverse and higher-order reverse
nreverse :: [a] -> [a]
nreverse [] = []
nreverse (x:xs) = (nreverse xs) ++ [x]

freverse :: [a] -> [a]
freverse xs = shunt xs []
   where
      shunt :: [a] -> [a] -> [a]
      shunt [] ys = ys
      shunt (x:xs) ys = shunt xs (x:ys)

hreverse :: [a] -> [a]
hreverse as = foldr (\ a f -> (\x -> f(a:x))) id as []

--8. Function to determine whether a tree is a AVL tree


--9. Factorial stuffs
--According to fact6, the factorial of 1891 is:
{-102393079373180920359357159982679099161059240
69923343459039300333411621494047196793583130301
03629307499537675502273121155012574786008799074
53526732348139697879240205809193824182578272238
54694741414145272812233163035960972210319391171
70971988513144026401092552275093182455317790246
07348051389861579406259377013866142006022846898
64451331888148443348564966241299603555158461479
47831765269435138485762951063246474300957380291
77895198348132973882545279430102705921165879806
72569418023668242209715447737881835639824653785
25987742797110217162191502240942234194249374247
60005499048266371432317608721923502826145594118
93441496229351572660290220715006567142583420221
51372761935167200792043446480560883858696415787
06984664891613361715069592270495185233976476690
23394677236158197225222744571496961539740603251
92815145653820898593939518654305231309477801807
76248740345154932280886678623091653979464500870
21486891382934430586271069345937594868962198665
80185649199064147510345917253941542653977008615
75315354536323468086647506568824458401293720103
54860789796027307398918992947134216105576644212
72971986633401453254377133465073597407253428861
52638883603140928054222081817501639786883189593   it keeps going but I got lazy and didnt want to space this more
10464745562689968233963059416564775388135836344835410761126596522353846766449548492381888378252843218226947730017734073407976310560667019804624399748249585509764326000902616969879241529958140701552067611175771559385535570117086837053227262027159758539521476081258137024118549195046691029100898217285128706217421909560943679443304290843022853257681161191918031056524485773773213515960653273862471541023458652072322539454509558311112969463398218570028055917764123886672737924399205056765593871791862923123214962695540090775869379611759695689369207107968811230655082256655682278553071594960812156282505196576752970422858153277965189285477069146886260136194377695888523133818603207567786036075241443243019990128604775826389333948596256129565682755449818882555833230508229048072957318404758405220560496582455038690388574281481627878795984103223977372601456347063441319564721587888878078992982747036715133959718251222598615361930431503876501754662200834484826794157416940977452421131910520470040611181806594096952324878470198615427012561263469206776799335623830345192756475626315125115241902209025722571459253023633762172884317019421149883763653955142877781355372013410420935226059143471230330321614225015113631707996477629080060007049619877259496358392112998368995453752074475178102429975439489845394247893324620903888728288998915587530159184332705153441275431517388886079671900966440677965111987454521806357815723573122352130622801203044258413629837474825455283793206700434934055637880031018709553493086533283299598147902139029832397116444327302112570420579608733907005802473367293090970313743848301839607768487159633462861071865209080549663436416518798211050715802035623590346239875831671924206465590123593558161210723844328317462947976507842730963842876400139505273899790354445000200060099112853198784369878833278289020504645144232163283082549759696405050785147339285067321399590615458603445167408865321968179108714070746825428186389499373563281803841895119258421455600554770460497605320299846206852690587446856046128568061673662782241555479971620251929199452427447068589349357108357224613007201879790953034007188913177500406175443526370140611378475661386623088301290304917407379720596721003283638208448183731877783436101188457376369571879771638903533311476824965536064107184338035095878244289628104750714006048005881240171707509600982484634796369403787905978073734681881830044572993676379368051951815619406974151836866737539472241889309412747916502230356039107385718812267377929677704371342625315692788086653103111606402608036462936340176184080770876028372330773465847595240307639375431824026784587874465731751042539320533355224955523335035022958596553115155837958131257636769012520289336083061573990179337416661942510537304980694922761862185797076018421509614807562226842545426984861370138292348737323380707045267947861091366655410053313634873037885222456336094529393502806877589923103451760629465939734284925323243568296109177163062733907007796199817038853302645181919778469477325542728735178588299561710429133916191093110955478452279467276803059638188989543226699861764336198101455254804633246409784970411473154347883847185755230139990857801761560403226242971599966661589367435743534431641286170445120588508997306668822137295931298987029778750961995220125482931205274605925234725033979553820120816804492079163733760972552873509808462198633314649906905012170460135520606430980629103618335257332615789343761381026120705954643651773638723307710237573646129573640726992917252830832803084614050477830391104978159573833804646305395237161874654616058825312221079232950554275584909831801714682360371875446371281954786370402470543546926128263726840888523291251099667347264619964240395568840071474413889202105818880031973717065206427694399488000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000-}
--6 ways to program a way to calculate factorials are shown below
--Product of 1 to n
fact1 :: Integer -> Integer
fact1 n = product [1..n] 

--Using compostion
--fact2 :: Integer -> Integer
--fact2 product.enumFromTo 1

--Recursion without libary functions
fact3 :: Integer -> Integer
fact3 0 = 1
fact3 n = n * fact3 (n - 1)

--Tail-recursive
fact4 :: Integer -> Integer
fact4 n
   | n >= 0 = go 1 n
   | otherwise = error "Negative factorial"
      where go acc 0 = acc
            go acc n = go (acc * n) (n - 1)

--With a left fold
fact5 :: Integer -> Integer
fact5 n = foldl (*) 1 [1..n]

--With a right fold
factorial6 :: Integer -> Integer
factorial6 n = foldr(\x g n -> g (x*n)) id [1..n] 1

fact7 :: Int -> Int
fact7 n = facs !! n
   where
      facs = scanl (*) 1 [1..]